function is_in = isinendoftube(tube, pos)
    is_in = pos(:,3) > tube.range_z(1) & ...
            pos(:,3) < tube.range_z(2) & ...
            isintube(tube, pos);        
end